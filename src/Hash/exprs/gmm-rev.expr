App () (Lam () "gmm_knossos_tri" (App () (Lam () "exp$VecR" (App () (Lam () "mul$R$VecR" (App () (Lam () "mul$R$VecVecR" (App () (Lam () "mul$VecR$VecR" (App () (Lam () "sub$VecR$VecR" (App () (Lam () "fwd$dot" (App () (Lam () "rev$dot" (App () (Lam () "dot" (App () (Lam () "sqnorm" (App () (Lam () "fwd$mul$Mat$Vec" (App () (Lam () "gmm_knossos_makeQ" (App () (Lam () "logsumexp" (App () (Lam () "log_gamma_distrib" (App () (Lam () "log_wishart_prior" (App () (Lam () "gmm_knossos_gmm_objective" (App () (Lam () "mkfloat" (App () (Lam () "mkvec" (App () (Lam () "mkvecvec" (App () (Lam () "var[D]" (App () (Lam () "var[N]" (App () (Lam () "var[K]" (App () (Lam () "var[seed]" (App () (Lam () "var[scale_unity]" (App () (Lam () "var[scale_small]" (App () (Lam () "var[x]" (App () (Lam () "var[alphas]" (App () (Lam () "var[mus]" (App () (Lam () "var[qs]" (App () (Lam () "var[ls]" (App () (Lam () "var[wishart]" (App () (Var () "func[pr]") (App () (App () (Var () "makeTuple") (Var () "var[x]")) (App () (Var () "func[rev$gmm_knossos_gmm_objective]") (App () (App () (Var () "makeTuple") (App () (Var () "func[tuple]") (App () (App () (App () (App () (App () (App () (Var () "makeTuple") (Var () "var[x]")) (Var () "var[alphas]")) (Var () "var[mus]")) (Var () "var[qs]")) (Var () "var[ls]")) (Var () "var[wishart]")))) (Var () "const[1.0]")))))) (App () (Var () "func[tuple]") (App () (App () (Var () "makeTuple") (Var () "const[3.1]")) (Var () "const[7]"))))) (App () (Var () "func[mkvecvec]") (App () (App () (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[seed]")) (Var () "const[4000]")))) (Var () "var[K]")) (App () (Var () "func[gmm_knossos_tri]") (Var () "var[D]"))) (Var () "var[scale_unity]"))))) (App () (Var () "func[mkvecvec]") (App () (App () (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[seed]")) (Var () "const[3000]")))) (Var () "var[K]")) (Var () "var[D]")) (Var () "var[scale_small]"))))) (App () (Var () "func[mkvecvec]") (App () (App () (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[seed]")) (Var () "const[2000]")))) (Var () "var[K]")) (Var () "var[D]")) (Var () "var[scale_unity]"))))) (App () (Var () "func[mkvec]") (App () (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[seed]")) (Var () "const[1000]")))) (Var () "var[K]")) (Var () "var[scale_unity]"))))) (App () (Var () "func[mkvecvec]") (App () (App () (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[seed]")) (Var () "const[0]")))) (Var () "var[N]")) (Var () "var[D]")) (Var () "var[scale_unity]"))))) (Var () "const[0.1]"))) (Var () "const[1.0]"))) (Var () "const[0]"))) (Var () "const[64]"))) (Var () "const[5]"))) (Var () "const[64]"))) (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (Var () "var[n]")) (Lam () "Var(name='var[j]')" (App () (Var () "func[mkvec]") (App () (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "var[j]")) (Var () "var[m]")))) (Var () "var[seed]")))) (Var () "var[m]")) (Var () "var[scale]")))))))) (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (Var () "var[n]")) (Lam () "Var(name='var[j]')" (App () (Var () "func[mkfloat]") (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[j]")) (Var () "var[seed]")))) (Var () "var[scale]")))))))) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (App () (Var () "func[$ranhashdoub]") (Var () "var[seed]"))) (Var () "var[scale]"))))) (App () (Lam () "var[N]" (App () (Lam () "var[K]" (App () (Lam () "var[D]" (App () (Lam () "var[triD]" (App () (Var () "assert") (App () (App () (Var () "makeTuple") (App () (Var () "func[eq]") (App () (App () (Var () "makeTuple") (Var () "var[triD]")) (App () (Var () "func[gmm_knossos_tri]") (Var () "var[D]"))))) (App () (Lam () "var[CONSTANT]" (App () (Lam () "var[sum_qs]" (App () (Lam () "var[slse]" (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[CONSTANT]")) (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (Var () "var[slse]")) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (App () (Var () "func[to_float]") (Var () "var[N]"))) (App () (Var () "func[logsumexp]") (Var () "var[alphas]"))))))))) (App () (Var () "func[sum]") (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (Var () "var[K]")) (Lam () "Var(name='var[k]')" (App () (Var () "func[log_wishart_prior]") (App () (App () (App () (Var () "makeTuple") (Var () "var[wishart]")) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[k]")) (Var () "var[qs]")))) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[k]")) (Var () "var[ls]")))))))))))) (App () (Var () "func[sum]") (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (Var () "var[N]")) (Lam () "Var(name='var[i]')" (App () (Var () "func[logsumexp]") (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (Var () "var[K]")) (Lam () "Var(name='var[k]')" (App () (Lam () "var[Q]" (App () (Lam () "var[mahal_vec]" (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[k]")) (Var () "var[alphas]")))) (App () (Var () "func[sum]") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[k]")) (Var () "var[qs]"))))))) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "const[0.5]")) (App () (Var () "func[sqnorm]") (Var () "var[mahal_vec]"))))))) (App () (Var () "func[mul$Mat$Vec]") (App () (App () (Var () "makeTuple") (Var () "var[Q]")) (App () (Var () "func[sub$VecR$VecR]") (App () (App () (Var () "makeTuple") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[x]")))) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[k]")) (Var () "var[means]"))))))))) (App () (Var () "func[gmm_knossos_makeQ]") (App () (App () (Var () "makeTuple") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[k]")) (Var () "var[qs]")))) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[k]")) (Var () "var[ls]")))))))))))))))) (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (Var () "var[K]")) (Lam () "Var(name='var[k12]')" (App () (Var () "func[sum]") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[k12]")) (Var () "var[qs]"))))))))) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (App () (Var () "func[to_float]") (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "var[N]")) (Var () "var[D]"))))) (App () (Var () "func[neg]") (Var () "const[0.9189385332046727]")))))))) (App () (Var () "func[size]") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "const[0]")) (Var () "var[ls]")))))) (App () (Var () "func[size]") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "const[0]")) (Var () "var[x]")))))) (App () (Var () "func[size]") (Var () "var[alphas]")))) (App () (Var () "func[size]") (Var () "var[x]"))))) (App () (Lam () "var[p]" (App () (Lam () "var[wishart_gamma]" (App () (Lam () "var[wishart_m]" (App () (Lam () "var[sum_qs]" (App () (Lam () "var[Qdiag]" (App () (Lam () "var[n]" (App () (Lam () "var[C]" (App () (Lam () "var[frobenius]" (App () (Lam () "var[w2f]" (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (Var () "var[w2f]")) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (App () (Var () "func[to_float]") (Var () "var[wishart_m]"))) (Var () "var[sum_qs]")))))) (Var () "var[C]")))) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "const[0.5]")) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "var[wishart_gamma]")) (Var () "var[wishart_gamma]")))) (Var () "var[frobenius]"))))))) (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (App () (Var () "func[sqnorm]") (Var () "var[Qdiag]"))) (App () (Var () "func[sqnorm]") (Var () "var[ltri_Q]")))))) (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (App () (Var () "func[to_float]") (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "var[n]")) (Var () "var[p]"))))) (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (App () (Var () "func[log]") (Var () "var[wishart_gamma]"))) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "const[0.5]")) (App () (Var () "func[log]") (Var () "const[2.0]"))))))))) (App () (Var () "func[log_gamma_distrib]") (App () (App () (Var () "makeTuple") (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "const[0.5]")) (App () (Var () "func[to_float]") (Var () "var[n]"))))) (Var () "var[p]"))))))) (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[p]")) (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[wishart_m]")) (Var () "const[1]"))))))) (App () (Var () "func[exp$VecR]") (Var () "var[log_Qdiag]")))) (App () (Var () "func[sum]") (Var () "var[log_Qdiag]")))) (App () (Var () "func[get$2$2]") (Var () "var[wishart]")))) (App () (Var () "func[get$1$2]") (Var () "var[wishart]")))) (App () (Var () "func[size]") (Var () "var[log_Qdiag]"))))) (App () (Lam () "var[out]" (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (Var () "var[out]")) (App () (Var () "func[sum]") (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (Var () "var[p]")) (Lam () "Var(name='var[j]')" (App () (Var () "func[lgamma]") (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (Var () "var[a]")) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "const[0.5]")) (App () (Var () "func[to_float]") (Var () "var[j]")))))))))))))) (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "const[0.28618247146235004]")) (App () (Var () "func[to_float]") (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "var[p]")) (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (Var () "var[p]")) (Var () "const[1]"))))))))))) (App () (Var () "func[log]") (App () (Var () "func[sum]") (App () (Var () "func[exp$VecR]") (Var () "var[v]")))))) (App () (Lam () "var[D]" (App () (Var () "assert") (App () (App () (Var () "makeTuple") (App () (Var () "func[eq]") (App () (App () (Var () "makeTuple") (App () (Var () "func[size]") (Var () "var[l]"))) (App () (Var () "func[gmm_knossos_tri]") (Var () "var[D]"))))) (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (Var () "var[D]")) (Lam () "Var(name='var[i]')" (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (Var () "var[D]")) (Lam () "Var(name='var[j]')" (App () (Var () "if") (App () (App () (App () (Var () "makeTuple") (App () (Var () "func[lt]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[j]")))) (Var () "const[0.0]")) (App () (Var () "if") (App () (App () (App () (Var () "makeTuple") (App () (Var () "func[eq]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[j]")))) (App () (Var () "func[exp]") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[q]"))))) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (App () (Var () "func[gmm_knossos_tri]") (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "const[1]"))))) (Var () "var[j]")))) (Var () "var[l]")))))))))))))))) (App () (Var () "func[size]") (Var () "var[q]"))))) (App () (Lam () "var[M]" (App () (Lam () "var[v]" (App () (Lam () "var[dM]" (App () (Lam () "var[dv]" (App () (Var () "func[ts_add]") (App () (App () (Var () "makeTuple") (App () (Var () "func[mul$Mat$Vec]") (App () (App () (Var () "makeTuple") (Var () "var[dM]")) (Var () "var[v]")))) (App () (Var () "func[mul$Mat$Vec]") (App () (App () (Var () "makeTuple") (Var () "var[M]")) (Var () "var[dv]")))))) (App () (Var () "func[get$2$2]") (Var () "var[dM_dv]")))) (App () (Var () "func[get$1$2]") (Var () "var[dM_dv]")))) (App () (Var () "func[get$2$2]") (Var () "var[M_v]")))) (App () (Var () "func[get$1$2]") (Var () "var[M_v]"))))) (App () (Var () "func[dot]") (App () (App () (Var () "makeTuple") (Var () "var[v]")) (Var () "var[v]"))))) (App () (Var () "func[sum]") (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (App () (Var () "func[size]") (Var () "var[a]"))) (Lam () "Var(name='var[i]')" (App () (Var () "func[dot]") (App () (App () (Var () "makeTuple") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[a]")))) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[b]"))))))))))) (App () (Lam () "var[a]" (App () (Lam () "var[b]" (App () (Var () "func[tuple]") (App () (App () (Var () "makeTuple") (App () (Var () "func[mul$R$VecR]") (App () (App () (Var () "makeTuple") (Var () "var[dr]")) (Var () "var[b]")))) (App () (Var () "func[mul$R$VecR]") (App () (App () (Var () "makeTuple") (Var () "var[dr]")) (Var () "var[a]")))))) (App () (Var () "func[get$2$2]") (Var () "var[a_b]")))) (App () (Var () "func[get$1$2]") (Var () "var[a_b]"))))) (App () (Lam () "var[a]" (App () (Lam () "var[b]" (App () (Lam () "var[da]" (App () (Lam () "var[db]" (App () (Var () "func[add]") (App () (App () (Var () "makeTuple") (App () (Var () "func[dot]") (App () (App () (Var () "makeTuple") (Var () "var[a]")) (Var () "var[db]")))) (App () (Var () "func[dot]") (App () (App () (Var () "makeTuple") (Var () "var[da]")) (Var () "var[b]")))))) (App () (Var () "func[get$2$2]") (Var () "var[da_db]")))) (App () (Var () "func[get$1$2]") (Var () "var[da_db]")))) (App () (Var () "func[get$2$2]") (Var () "var[a_b]")))) (App () (Var () "func[get$1$2]") (Var () "var[a_b]"))))) (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (App () (Var () "func[size]") (Var () "var[a]"))) (Lam () "Var(name='var[i]')" (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[a]")))) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[b]")))))))))) (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (App () (Var () "func[size]") (Var () "var[a]"))) (Lam () "Var(name='var[i]')" (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[a]")))) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[b]")))))))))) (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (App () (Var () "func[size]") (Var () "var[a]"))) (Lam () "Var(name='var[i]')" (App () (Var () "func[mul$R$VecR]") (App () (App () (Var () "makeTuple") (Var () "var[r]")) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[a]")))))))))) (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (App () (Var () "func[size]") (Var () "var[a]"))) (Lam () "Var(name='var[i]')" (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "var[r]")) (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[a]")))))))))) (App () (Var () "func[build]") (App () (App () (Var () "makeTuple") (App () (Var () "func[size]") (Var () "var[v]"))) (Lam () "Var(name='var[i]')" (App () (Var () "func[exp]") (App () (Var () "func[index]") (App () (App () (Var () "makeTuple") (Var () "var[i]")) (Var () "var[v]"))))))))) (App () (Var () "func[div]") (App () (App () (Var () "makeTuple") (App () (Var () "func[mul]") (App () (App () (Var () "makeTuple") (Var () "var[n]")) (App () (Var () "func[sub]") (App () (App () (Var () "makeTuple") (Var () "var[n]")) (Var () "const[1]")))))) (Var () "const[2]")))